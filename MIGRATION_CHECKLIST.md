# ‚úÖ Checklist –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ Hexagonal Architecture

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ:

### ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
- [x] –°–æ–∑–¥–∞–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫ (core, ports, adapters, app, pkg)
- [x] internal/domain/ ‚Üí internal/core/
- [x] internal/repository/ ‚Üí internal/adapters/db/
- [x] internal/controller/ ‚Üí internal/adapters/bot/telegram/
- [x] Package domain ‚Üí package core –≤–æ –≤—Å–µ—Ö —Ñ–∞–π–ª–∞—Ö

### ‚úÖ Ports (–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã)
- [x] ports/repo.go - –≤—Å–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
- [x] ports/marzban.go - Marzban interface
- [x] ports/notifier.go - Notifier interface
- [x] ports/clock.go - Clock interface

### ‚úÖ Adapters
- [x] db/postgres/* - PostgreSQL —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
- [x] marzban/client.go - Marzban –∫–ª–∏–µ–Ω—Ç
- [x] notify/tg_notifier.go - Telegram Notifier
- [x] payment/mock_provider.go - Mock Payment Provider
- [x] bot/telegram/ - Telegram bot –∞–¥–∞–ø—Ç–µ—Ä

### ‚úÖ UseCase
- [x] –í—Å–µ UseCase –∏—Å–ø–æ–ª—å–∑—É—é—Ç ports –≤–º–µ—Å—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ç–∏–ø–æ–≤
- [x] PaymentUseCase - –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä (–≤—ã–∑—ã–≤–∞–µ—Ç –¥—Ä—É–≥–∏–µ UC)
- [x] VPNUseCase - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å Marzban —á–µ—Ä–µ–∑ –ø–æ—Ä—Ç
- [x] NotificationUseCase - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —á–µ—Ä–µ–∑ portstifier
- [x] –£–±—Ä–∞–Ω—ã –ø—Ä—è–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–∞ Telegram/SQL

### ‚úÖ Application Layer
- [x] app/container.go - DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
- [x] app/run.go - –∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- [x] cmd/bot/main.go - —É–ø—Ä–æ—â–µ–Ω –¥–æ –º–∏–Ω–∏–º—É–º–∞

### ‚úÖ Infrastructure
- [x] pkg/config/config.go - –∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- [x] pkg/logger/logger.go - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- [x] pkg/errors/errors.go - –æ–±—â–∏–µ –æ—à–∏–±–∫–∏
- [x] configs/config.yaml - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª

### ‚úÖ –°–±–æ—Ä–∫–∞
- [x] –ü—Ä–æ–µ–∫—Ç –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è: `go build ./cmd/bot`
- [x] –ë–∏–Ω–∞—Ä–Ω–∏–∫ —Å–æ–∑–¥–∞–µ—Ç—Å—è: `bin/bot`
- [x] –ù–µ—Ç –æ—à–∏–±–æ–∫ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏

## üîç –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

### 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã
```bash
# UseCase –Ω–µ –¥–æ–ª–∂–Ω—ã –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å telegram/sql
grep -r "telegram-bot-api" internal/usecase/
grep -r "pgx" internal/usecase/
grep -r "http" internal/usecase/

# –î–æ–ª–∂–Ω—ã –≤–µ—Ä–Ω—É—Ç—å –ø—É—Å—Ç–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏–ª–∏ —Ç–æ–ª—å–∫–æ —Ç–µ—Å—Ç—ã
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≥—Ä–∞—Ñ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
go mod graph | grep "3xui-bot"
```

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ª–∏–Ω—Ç–µ—Ä
```bash
golangci-lint run ./...
# –∏–ª–∏
go vet ./...
```

### 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
```bash
ls -l migrations/
# –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤—Å–µ .sql —Ñ–∞–π–ª—ã
```

### 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
```bash
cat configs/config.yaml
cat env.sample
# –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç
```

## üìã Definition of Done

### –ö—Ä–∏—Ç–∏—á–Ω–æ:
- [x] ‚úÖ –ü—Ä–æ–µ–∫—Ç —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [x] ‚úÖ UseCase –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—Ç –≤–Ω–µ—à–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
- [x] ‚úÖ –í—Å–µ —á–µ—Ä–µ–∑ ports (–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã)
- [x] ‚úÖ Adapters —Ä–µ–∞–ª–∏–∑—É—é—Ç ports
- [x] ‚úÖ Migrations —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã

### –í–∞–∂–Ω–æ:
- [x] ‚úÖ Handlers —Ç–æ–Ω–∫–∏–µ (parse ‚Üí usecase ‚Üí render)
- [x] ‚úÖ Scheduler –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ usecase
- [x] ‚úÖ DI –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ (container.go)
- [x] ‚úÖ Graceful shutdown
- [x] ‚úÖ Config —á–µ—Ä–µ–∑ pkg/config

### –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ:
- [ ] ‚è≥ –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è usecase
- [ ] ‚è≥ –ù–∞–ø–∏—Å–∞—Ç—å integration —Ç–µ—Å—Ç—ã
- [ ] ‚è≥ –î–æ–±–∞–≤–∏—Ç—å README —Å –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π
- [ ] ‚è≥ –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—É—Å–∫:**
```bash
# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
psql -d 3xui_bot -f migrations/001_complete_schema.sql
psql -d 3xui_bot -f migrations/002_seed_plans.sql

# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å .env
cp env.sample .env
# –ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

# –ó–∞–ø—É—Å—Ç–∏—Ç—å
./bin/bot
```

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É:**
- `/start` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –í—ã–±–æ—Ä –ø–ª–∞–Ω–∞
- –°–æ–∑–¥–∞–Ω–∏–µ VPN
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

3. **–î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã:**
```bash
# –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ usecase
touch internal/usecase/payment_test.go
touch internal/usecase/vpn_test.go
```

4. **–ó–∞–º–µ–Ω–∏—Ç—å Mock Payment Provider:**
```bash
# –°–æ–∑–¥–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä
touch internal/adapters/payment/yookassa_provider.go
```

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

### –§–∞–π–ª—ã:
- –°–æ–∑–¥–∞–Ω–æ: ~40 —Ñ–∞–π–ª–æ–≤
- –ü–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ: ~30 —Ñ–∞–π–ª–æ–≤  
- –û–±–Ω–æ–≤–ª–µ–Ω–æ: ~50 —Ñ–∞–π–ª–æ–≤

### –°—Ç—Ä–æ–∫–∏ –∫–æ–¥–∞:
- internal/core: ~500 —Å—Ç—Ä–æ–∫
- internal/ports: ~150 —Å—Ç—Ä–æ–∫
- internal/usecase: ~1500 —Å—Ç—Ä–æ–∫
- internal/adapters: ~2000 —Å—Ç—Ä–æ–∫
- internal/app: ~200 —Å—Ç—Ä–æ–∫

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:
- –°–ª–æ–µ–≤: 4 (Core, Ports, UseCase, Adapters)
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤: 12
- –î–æ–º–µ–Ω–Ω—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π: 6
- Use Cases: 6
- Adapters: 4 —Ç–∏–ø–∞ (DB, Marzban, Notifier, Bot)

## ‚ú® –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø–∞–º Hexagonal/Clean Architecture:

- ‚úÖ –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–ª–æ–µ–≤
- ‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –≤–Ω—É—Ç—Ä—å
- ‚úÖ –õ–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
- ‚úÖ –õ–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å
- ‚úÖ –õ–µ–≥–∫–æ –º–µ–Ω—è—Ç—å –¥–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚úÖ –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–∞

**–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üöÄ

